'''
Helper script: re-order the import count features
'''
import ConfigParser
from itertools import izip
import cPickle
import csv
import numpy as np
import os
import sys


filecount = 0
train_label = []
path_data = Config.get("Train","feature_save")
path_label = Config.get("Train","label")
path_save = Config.get("Train","model")

label_count = 0      
with open(path_label) as f:
    for line in f:
        label_count+=1
        line = line.split(".")
        train_label.append(line[0].strip()) 

data_name = []
data = []
header = []

linecount = 0
with open(os.path.join(path_data,"import_count")) as ic:
    for line2 in ic:
        linecount += 1
        if(linecount==1):
            header = line2.split("\t")
            idx = header.index("Filename")
            print(len(header))
            del header[idx]
            print(len(header))

        else:
            import_data = line2.split("\t")
            data_name.append(import_data[idx].strip())
            data_to_add = import_data
            del data_to_add[idx]
            data.append(data_to_add)
            if(len(data_to_add)!=len(header)):
                print(len(data_to_add))


with open(os.path.join(path_save,"organized_import"),'wb+') as f:
    w = csv.writer(f,delimiter="\t")
    w.writerow(header)
    print(len(header))
label_idx = 0
writecount = 0
for label_idx in range(len(train_label)):
    name = train_label[label_idx]
    idx = data_name.index(name)
    to_write = data[idx]

    with open(os.path.join(path_save,"organized_import"),'ab+') as f:
        w = csv.writer(f,delimiter="\t")
        w.writerow(to_write)
        writecount+=1
    print("Finish organizing: "+str(writecount)+" "+name + " "+data_name[idx])
    if(len(to_write)!=len(header)):
        print(len(to_write))

    label_idx+=1


    
